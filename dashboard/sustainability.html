<!doctype html>
<html lang="no">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="description"
      content="B√¶rekraft - CO2-besparelser og milj√∏analyse for rehabilitering vs. nybygg"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>B√¶rekraftsrapport | Hovfaret 13</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg-primary: #f8fafc;
        --bg-secondary: #ffffff;
        --bg-tertiary: #f1f5f9;
        --text-primary: #1e293b;
        --text-secondary: #475569;
        --text-muted: #94a3b8;
        --border-color: #e2e8f0;
        --accent-green: #10b981;
        --accent-green-light: #d1fae5;
        --accent-red: #ef4444;
        --accent-red-light: #fee2e2;
        --accent-blue: #3b82f6;
        --accent-blue-light: #dbeafe;
        --accent-orange: #f59e0b;
        --accent-orange-light: #fef3c7;
        --accent-purple: #8b5cf6;
        --radius-sm: 6px;
        --radius-md: 10px;
        --radius-lg: 16px;
        --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        line-height: 1.6;
      }

      /* Header */
      .header {
        background: var(--bg-secondary);
        border-bottom: 1px solid var(--border-color);
        padding: 1rem 2rem;
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .back-link {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary);
        text-decoration: none;
        font-size: 0.9rem;
        transition: color 0.2s;
      }

      .back-link:hover {
        color: var(--accent-green);
      }

      .page-title {
        font-size: 1.25rem;
        font-weight: 600;
      }

      .report-nav {
        display: flex;
        gap: 0.5rem;
      }

      .report-nav-btn {
        padding: 0.5rem 1rem;
        border: 1px solid var(--border-color);
        background: var(--bg-secondary);
        border-radius: var(--radius-sm);
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s;
      }

      .report-nav-btn:hover {
        border-color: var(--accent-green);
        color: var(--accent-green);
      }

      .report-nav-btn.active {
        background: var(--accent-green);
        color: white;
        border-color: var(--accent-green);
      }

      /* Main content */
      .main-content {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
      }

      /* Hero Section */
      .hero {
        background: linear-gradient(
          135deg,
          var(--accent-green) 0%,
          #059669 100%
        );
        border-radius: var(--radius-lg);
        padding: 3rem;
        color: white;
        margin-bottom: 2rem;
      }

      .hero-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .hero-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        margin-bottom: 2rem;
      }

      .hero-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
      }

      .hero-stat {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        border-radius: var(--radius-md);
        padding: 1.25rem;
        text-align: center;
      }

      .hero-stat-value {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.25rem;
      }

      .hero-stat-label {
        font-size: 0.85rem;
        opacity: 0.9;
      }

      /* Section */
      .section {
        margin-bottom: 3rem;
      }

      .section-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border-color);
      }

      .section-icon {
        width: 48px;
        height: 48px;
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
      }

      .section-icon.klimagass {
        background: var(--accent-blue-light);
      }
      .section-icon.energi {
        background: var(--accent-orange-light);
      }

      .section-title {
        font-size: 1.5rem;
        font-weight: 600;
      }

      .section-meta {
        font-size: 0.85rem;
        color: var(--text-muted);
      }

      /* Report Carousel */
      .report-carousel-container {
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
        border: 1px solid var(--border-color);
        overflow: hidden;
        margin-bottom: 2rem;
      }

      .carousel-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem 1.5rem;
        border-bottom: 1px solid var(--border-color);
        background: var(--bg-tertiary);
      }

      .carousel-title {
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .carousel-controls {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .carousel-page-info {
        font-size: 0.9rem;
        color: var(--text-secondary);
      }

      .carousel-btn {
        width: 36px;
        height: 36px;
        border-radius: var(--radius-sm);
        border: 1px solid var(--border-color);
        background: var(--bg-secondary);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
      }

      .carousel-btn:hover {
        border-color: var(--accent-green);
        color: var(--accent-green);
      }

      .carousel-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .expand-btn {
        padding: 0.5rem 1rem;
        border-radius: var(--radius-sm);
        border: 1px solid var(--border-color);
        background: var(--bg-secondary);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.85rem;
        transition: all 0.2s;
      }

      .expand-btn:hover {
        background: var(--accent-green);
        color: white;
        border-color: var(--accent-green);
      }

      .carousel-viewport {
        position: relative;
        height: 500px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f0f0f0;
        overflow: hidden;
      }

      .carousel-image {
        max-height: 100%;
        max-width: 100%;
        object-fit: contain;
        cursor: zoom-in;
        transition: transform 0.3s;
      }

      .carousel-dots {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        padding: 1rem;
        background: var(--bg-tertiary);
        flex-wrap: wrap;
      }

      .carousel-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--border-color);
        cursor: pointer;
        transition: all 0.2s;
      }

      .carousel-dot:hover {
        background: var(--text-muted);
      }

      .carousel-dot.active {
        background: var(--accent-green);
        transform: scale(1.3);
      }

      /* Fullscreen Modal */
      .fullscreen-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.95);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        flex-direction: column;
      }

      .fullscreen-modal.active {
        display: flex;
      }

      .fullscreen-close {
        position: absolute;
        top: 1rem;
        right: 1rem;
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        transition: background 0.2s;
      }

      .fullscreen-close:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .fullscreen-controls {
        position: absolute;
        bottom: 2rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        background: rgba(0, 0, 0, 0.5);
        padding: 1rem 2rem;
        border-radius: var(--radius-lg);
      }

      .fullscreen-btn {
        width: 48px;
        height: 48px;
        border-radius: var(--radius-sm);
        border: 1px solid rgba(255, 255, 255, 0.3);
        background: transparent;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
        transition: all 0.2s;
      }

      .fullscreen-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: white;
      }

      .fullscreen-page-info {
        color: white;
        font-size: 1rem;
        min-width: 80px;
        text-align: center;
      }

      .fullscreen-image-container {
        max-width: 90vw;
        max-height: 80vh;
        overflow: auto;
      }

      .fullscreen-image {
        max-width: 100%;
        transition: transform 0.3s;
        cursor: grab;
      }

      .fullscreen-image.zoomed {
        max-width: none;
        cursor: grabbing;
      }

      .zoom-controls {
        display: flex;
        gap: 0.5rem;
      }

      /* Scenario Cards */
      .scenario-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      @media (max-width: 900px) {
        .scenario-grid {
          grid-template-columns: 1fr;
        }
      }

      .scenario-card {
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
        border: 2px solid var(--border-color);
        overflow: hidden;
        transition: all 0.2s;
      }

      .scenario-card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-2px);
      }

      .scenario-card.not-recommended {
        border-color: var(--accent-red);
      }
      .scenario-card.recommended {
        border-color: var(--accent-green);
      }
      .scenario-card.preferred {
        border-color: var(--accent-blue);
      }

      .scenario-header {
        padding: 1.25rem;
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .scenario-card.not-recommended .scenario-header {
        background: var(--accent-red-light);
      }
      .scenario-card.recommended .scenario-header {
        background: var(--accent-green-light);
      }
      .scenario-card.preferred .scenario-header {
        background: var(--accent-blue-light);
      }

      .scenario-icon {
        width: 48px;
        height: 48px;
        border-radius: var(--radius-md);
        background: var(--bg-secondary);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
      }

      .scenario-name {
        font-weight: 600;
        font-size: 1.1rem;
      }

      .scenario-status {
        font-size: 0.8rem;
        padding: 0.25rem 0.75rem;
        border-radius: 999px;
        margin-top: 0.25rem;
        display: inline-block;
      }

      .scenario-card.not-recommended .scenario-status {
        background: var(--accent-red);
        color: white;
      }
      .scenario-card.recommended .scenario-status {
        background: var(--accent-green);
        color: white;
      }
      .scenario-card.preferred .scenario-status {
        background: var(--accent-blue);
        color: white;
      }

      .scenario-body {
        padding: 1.25rem;
      }

      .scenario-description {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin-bottom: 1rem;
        line-height: 1.5;
      }

      .scenario-metrics {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .scenario-metric {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 0;
        border-bottom: 1px solid var(--border-color);
      }

      .scenario-metric:last-child {
        border-bottom: none;
      }

      .metric-label {
        font-size: 0.85rem;
        color: var(--text-secondary);
      }

      .metric-value {
        font-weight: 600;
        font-size: 0.95rem;
      }

      .metric-comparison {
        font-size: 0.8rem;
        padding: 0.2rem 0.5rem;
        border-radius: var(--radius-sm);
        margin-left: 0.5rem;
      }

      .metric-comparison.positive {
        background: var(--accent-green-light);
        color: #059669;
      }
      .metric-comparison.negative {
        background: var(--accent-red-light);
        color: #dc2626;
      }

      /* Charts */
      .chart-container {
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
        border: 1px solid var(--border-color);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .chart-title {
        font-weight: 600;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .bar-chart {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .bar-row {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .bar-label {
        width: 150px;
        font-size: 0.9rem;
        flex-shrink: 0;
      }

      .bar-track {
        flex: 1;
        height: 32px;
        background: var(--bg-tertiary);
        border-radius: var(--radius-sm);
        overflow: hidden;
        position: relative;
      }

      .bar-fill {
        height: 100%;
        border-radius: var(--radius-sm);
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding-right: 0.75rem;
        color: white;
        font-weight: 600;
        font-size: 0.85rem;
        transition: width 0.5s ease-out;
      }

      .bar-fill.scenario-1 {
        background: linear-gradient(90deg, var(--accent-red), #dc2626);
      }
      .bar-fill.scenario-2 {
        background: linear-gradient(90deg, var(--accent-green), #059669);
      }
      .bar-fill.scenario-3 {
        background: linear-gradient(90deg, var(--accent-blue), #2563eb);
      }

      /* Stacked Bar Chart */
      .stacked-bar-chart {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }

      .stacked-row {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .stacked-bar {
        flex: 1;
        height: 40px;
        display: flex;
        border-radius: var(--radius-sm);
        overflow: hidden;
      }

      .stacked-segment {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
        font-weight: 600;
        color: white;
        transition: width 0.5s ease-out;
      }

      .segment-materials {
        background: #6366f1;
      }
      .segment-energy {
        background: #f59e0b;
      }

      .chart-legend {
        display: flex;
        gap: 1.5rem;
        margin-top: 1rem;
        justify-content: center;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.85rem;
      }

      .legend-color {
        width: 16px;
        height: 16px;
        border-radius: 4px;
      }

      /* Data Table */
      .data-table-container {
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
        border: 1px solid var(--border-color);
        overflow: hidden;
        margin-bottom: 1.5rem;
      }

      .data-table {
        width: 100%;
        border-collapse: collapse;
      }

      .data-table th {
        background: var(--bg-tertiary);
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        font-size: 0.85rem;
        border-bottom: 1px solid var(--border-color);
      }

      .data-table td {
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
        font-size: 0.9rem;
      }

      .data-table tr:last-child td {
        border-bottom: none;
      }

      .data-table tr:hover td {
        background: var(--bg-tertiary);
      }

      .data-table .recommended-row {
        background: var(--accent-green-light);
      }

      .data-table .recommended-row:hover td {
        background: #a7f3d0;
      }

      .npv-positive {
        color: var(--accent-green);
        font-weight: 600;
      }
      .npv-negative {
        color: var(--accent-red);
        font-weight: 600;
      }

      /* Energy Rating Scale */
      .energy-rating-container {
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
        border: 1px solid var(--border-color);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .rating-scale {
        display: flex;
        margin: 1.5rem 0;
        border-radius: var(--radius-md);
        overflow: hidden;
      }

      .rating-segment {
        flex: 1;
        padding: 1rem 0.5rem;
        text-align: center;
        font-weight: 700;
        font-size: 1.25rem;
        color: white;
        position: relative;
      }

      .rating-A {
        background: #22c55e;
      }
      .rating-B {
        background: #84cc16;
      }
      .rating-C {
        background: #eab308;
      }
      .rating-D {
        background: #f97316;
      }
      .rating-E {
        background: #ef4444;
      }
      .rating-F {
        background: #dc2626;
      }
      .rating-G {
        background: #991b1b;
      }

      .rating-marker {
        position: absolute;
        bottom: -20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.7rem;
        color: var(--text-secondary);
        white-space: nowrap;
      }

      .current-rating-indicator {
        position: absolute;
        top: -8px;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-top: 8px solid var(--text-primary);
      }

      /* Info Cards Grid */
      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .info-card {
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
        border: 1px solid var(--border-color);
        padding: 1.5rem;
      }

      .info-card-header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      .info-card-icon {
        width: 40px;
        height: 40px;
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
      }

      .info-card-title {
        font-weight: 600;
      }

      .info-card-content {
        font-size: 0.9rem;
        color: var(--text-secondary);
        line-height: 1.6;
      }

      .info-list {
        list-style: none;
        margin-top: 0.75rem;
      }

      .info-list li {
        padding: 0.5rem 0;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .info-list li:last-child {
        border-bottom: none;
      }

      /* Recommended Packages */
      .package-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      @media (max-width: 768px) {
        .package-grid {
          grid-template-columns: 1fr;
        }
      }

      .package-card {
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
        border: 2px solid var(--accent-green);
        overflow: hidden;
      }

      .package-header {
        background: var(--accent-green);
        color: white;
        padding: 1.25rem;
      }

      .package-name {
        font-weight: 600;
        font-size: 1.1rem;
        margin-bottom: 0.25rem;
      }

      .package-measures {
        font-size: 0.85rem;
        opacity: 0.9;
      }

      .package-body {
        padding: 1.25rem;
      }

      .package-metric {
        display: flex;
        justify-content: space-between;
        padding: 0.75rem 0;
        border-bottom: 1px solid var(--border-color);
      }

      .package-metric:last-child {
        border-bottom: none;
      }

      .package-metric-label {
        color: var(--text-secondary);
        font-size: 0.9rem;
      }

      .package-metric-value {
        font-weight: 600;
      }

      .package-rating {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        margin-top: 1rem;
        padding: 0.75rem 1rem;
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
      }

      .rating-badge {
        width: 32px;
        height: 32px;
        border-radius: var(--radius-sm);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        color: white;
      }

      /* Footer */
      .footer {
        margin-top: 3rem;
        padding: 2rem;
        background: var(--bg-secondary);
        border-top: 1px solid var(--border-color);
      }

      .footer-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        flex-wrap: wrap;
        gap: 2rem;
      }

      .footer-section h4 {
        font-weight: 600;
        margin-bottom: 0.75rem;
      }

      .footer-section p,
      .footer-section a {
        font-size: 0.9rem;
        color: var(--text-secondary);
      }

      .footer-section a {
        text-decoration: none;
        display: block;
        padding: 0.25rem 0;
      }

      .footer-section a:hover {
        color: var(--accent-green);
      }

      /* Responsive */
      @media (max-width: 768px) {
        .header-content {
          flex-direction: column;
          gap: 1rem;
        }
        .hero {
          padding: 2rem 1.5rem;
        }
        .hero-title {
          font-size: 1.75rem;
        }
        .main-content {
          padding: 1rem;
        }
        .bar-label {
          width: 100px;
          font-size: 0.8rem;
        }
      }

      /* Print styles */
      @media print {
        .header,
        .report-nav,
        .carousel-controls,
        .expand-btn {
          display: none;
        }
        .main-content {
          padding: 0;
        }
        .section {
          break-inside: avoid;
        }
      }

      /* === B√ÜREKRAFTSREISE SIDEBAR === */
      .page-layout {
        display: grid;
        grid-template-columns: 320px 1fr;
        gap: 2rem;
      }

      @media (max-width: 1200px) {
        .page-layout {
          grid-template-columns: 1fr;
        }
        .journey-sidebar {
          order: -1;
          max-height: 400px;
          overflow-y: auto;
        }
      }

      .journey-sidebar {
        position: sticky;
        top: 80px;
        height: calc(100vh - 100px);
        overflow-y: auto;
        padding-right: 1rem;
      }

      .journey-sidebar::-webkit-scrollbar {
        width: 6px;
      }

      .journey-sidebar::-webkit-scrollbar-track {
        background: var(--bg-tertiary);
        border-radius: 3px;
      }

      .journey-sidebar::-webkit-scrollbar-thumb {
        background: var(--accent-green);
        border-radius: 3px;
      }

      .journey-header {
        background: linear-gradient(
          135deg,
          var(--accent-green) 0%,
          #059669 100%
        );
        color: white;
        padding: 1.25rem;
        border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        margin-bottom: 0;
      }

      .journey-header h3 {
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .journey-header p {
        font-size: 0.75rem;
        opacity: 0.9;
      }

      .journey-stats {
        display: flex;
        gap: 1rem;
        margin-top: 0.75rem;
      }

      .journey-stat {
        text-align: center;
      }

      .journey-stat-value {
        font-size: 1.25rem;
        font-weight: 700;
      }

      .journey-stat-label {
        font-size: 0.65rem;
        opacity: 0.8;
      }

      .journey-container {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-top: none;
        border-radius: 0 0 var(--radius-lg) var(--radius-lg);
        padding: 1rem;
      }

      .journey-timeline {
        position: relative;
        padding-left: 24px;
      }

      .journey-timeline::before {
        content: "";
        position: absolute;
        left: 8px;
        top: 0;
        bottom: 0;
        width: 2px;
        background: linear-gradient(
          180deg,
          var(--accent-green) 0%,
          var(--accent-blue) 50%,
          var(--accent-purple) 100%
        );
      }

      .journey-item {
        position: relative;
        padding-bottom: 1.25rem;
        cursor: pointer;
        transition: all 0.2s;
      }

      .journey-item:last-child {
        padding-bottom: 0;
      }

      .journey-item:hover .journey-content {
        background: var(--bg-tertiary);
      }

      .journey-dot {
        position: absolute;
        left: -20px;
        top: 4px;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--bg-secondary);
        border: 3px solid var(--accent-green);
        z-index: 1;
      }

      .journey-item.deliverable .journey-dot {
        border-color: var(--accent-blue);
      }
      .journey-item.decision .journey-dot {
        border-color: var(--accent-purple);
      }
      .journey-item.engagement .journey-dot {
        border-color: var(--accent-orange);
      }
      .journey-item.technical .journey-dot {
        border-color: #64748b;
      }

      .journey-content {
        padding: 0.75rem;
        border-radius: var(--radius-sm);
        transition: background 0.2s;
      }

      .journey-date {
        font-size: 0.7rem;
        color: var(--text-muted);
        font-weight: 500;
        margin-bottom: 0.25rem;
      }

      .journey-title {
        font-size: 0.85rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.25rem;
        line-height: 1.3;
      }

      .journey-desc {
        font-size: 0.75rem;
        color: var(--text-secondary);
        line-height: 1.4;
        display: none;
      }

      .journey-item.expanded .journey-desc {
        display: block;
      }

      .journey-tag {
        display: inline-block;
        font-size: 0.6rem;
        padding: 0.15rem 0.4rem;
        border-radius: 3px;
        margin-top: 0.35rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .journey-tag.strategy {
        background: #dcfce7;
        color: #166534;
      }
      .journey-tag.deliverable {
        background: #dbeafe;
        color: #1e40af;
      }
      .journey-tag.technical {
        background: #f1f5f9;
        color: #475569;
      }
      .journey-tag.decision {
        background: #f3e8ff;
        color: #7c3aed;
      }
      .journey-tag.engagement {
        background: #fef3c7;
        color: #92400e;
      }
      .journey-tag.regulatory {
        background: #fce7f3;
        color: #be185d;
      }
      .journey-tag.partnership {
        background: #cffafe;
        color: #0e7490;
      }

      .journey-metrics {
        background: var(--bg-tertiary);
        border-radius: var(--radius-sm);
        padding: 0.5rem;
        margin-top: 0.5rem;
        display: none;
      }

      .journey-item.expanded .journey-metrics {
        display: block;
      }

      .journey-metric-row {
        display: flex;
        justify-content: space-between;
        font-size: 0.7rem;
        padding: 0.2rem 0;
      }

      .journey-metric-label {
        color: var(--text-muted);
      }

      .journey-metric-value {
        font-weight: 600;
        color: var(--accent-green);
      }

      .main-column {
        min-width: 0;
      }

      /* Year dividers in timeline */
      .journey-year {
        font-size: 0.7rem;
        font-weight: 700;
        color: var(--accent-green);
        padding: 0.5rem 0;
        margin-left: -24px;
        padding-left: 24px;
        background: linear-gradient(
          90deg,
          var(--accent-green-light) 0%,
          transparent 100%
        );
        border-radius: var(--radius-sm);
        margin-bottom: 0.5rem;
      }

      .journey-subtitle {
        font-size: 0.75rem;
        opacity: 0.9;
        margin: 0;
      }

      .journey-icon {
        font-size: 1rem;
        margin-bottom: 0.25rem;
      }

      .journey-description {
        font-size: 0.72rem;
        color: var(--text-secondary);
        line-height: 1.4;
        margin-top: 0.25rem;
      }

      .journey-summary {
        display: flex;
        justify-content: space-around;
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-top: none;
        border-radius: 0 0 var(--radius-lg) var(--radius-lg);
        padding: 1rem;
        margin-top: 0;
      }

      .journey-summary-stat {
        text-align: center;
      }

      .journey-summary-stat .stat-value {
        display: block;
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--accent-green);
      }

      .journey-summary-stat .stat-label {
        display: block;
        font-size: 0.65rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .journey-metrics .metric {
        display: inline-block;
        background: var(--accent-green-light);
        color: var(--accent-green);
        padding: 0.15rem 0.5rem;
        border-radius: 3px;
        font-size: 0.65rem;
        font-weight: 600;
        margin-right: 0.25rem;
      }

      .journey-timeline {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-top: none;
        padding: 1rem 1rem 1rem 2rem;
        max-height: calc(100vh - 280px);
        overflow-y: auto;
      }
    </style>
    <link rel="stylesheet" href="css/tabs.css" />
    <script src="lib/page-config.js"></script>
    <script src="lib/tab-router.js"></script>
    <script src="components/content-header.js"></script>
  </head>
  <body>
    <script>
      ContentHeader.inject("sustainability");
    </script>
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <a href="index.html" class="back-link">
          <svg
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M19 12H5M12 19l-7-7 7-7" />
          </svg>
          Tilbake til dashboard
        </a>
        <h1 class="page-title">B√¶rekraftsrapport</h1>
        <div class="report-nav">
          <button
            class="report-nav-btn active"
            onclick="scrollToSection('klimagass')"
          >
            Klimagass
          </button>
          <button class="report-nav-btn" onclick="scrollToSection('energi')">
            Energi
          </button>
        </div>
      </div>
    </header>

    <div class="page-layout">
      <!-- B√¶rekraftsreise Sidebar -->
      <aside class="journey-sidebar">
        <div class="journey-header">
          <h3>üå± B√¶rekraftsreisen</h3>
          <p class="journey-subtitle">25 m√•neder med b√¶rekraftsarbeid</p>
        </div>
        <div class="journey-timeline" id="journey-timeline">
          <!-- Timeline items loaded dynamically -->
        </div>
        <div class="journey-summary">
          <div class="journey-summary-stat">
            <span class="stat-value">17</span>
            <span class="stat-label">Milep√¶ler</span>
          </div>
          <div class="journey-summary-stat">
            <span class="stat-value">48%</span>
            <span class="stat-label">CO‚ÇÇ spart</span>
          </div>
          <div class="journey-summary-stat">
            <span class="stat-value">3</span>
            <span class="stat-label">Rapporter</span>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-column">
        <!-- Hero Section -->
        <section class="hero">
          <h2 class="hero-title">Transformasjon sparer 48% CO‚ÇÇ</h2>
          <p class="hero-subtitle">
            Livsl√∏psanalyse viser at rehabilitering er betydelig bedre for
            klimaet enn riving og nybygg
          </p>
          <a
            href="sustainability-report-full.html"
            class="report-link-btn"
            style="
              display: inline-flex;
              align-items: center;
              gap: 0.5rem;
              padding: 0.75rem 1.5rem;
              background: linear-gradient(135deg, #3d4a3a, #4a5a47);
              color: white;
              text-decoration: none;
              border-radius: 8px;
              font-weight: 500;
              margin-bottom: 1.5rem;
              transition: all 0.2s;
              box-shadow: 0 4px 12px rgba(61, 74, 58, 0.3);
            "
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
              />
              <polyline points="14 2 14 8 20 8" />
              <line x1="16" y1="13" x2="8" y2="13" />
              <line x1="16" y1="17" x2="8" y2="17" />
            </svg>
            Se full b√¶rekraftsrapport (83 sider + data)
            <span
              style="
                background: #dc2626;
                color: white;
                padding: 0.125rem 0.5rem;
                border-radius: 4px;
                font-size: 0.7rem;
                font-weight: 600;
              "
              >UTKAST</span
            >
          </a>
          <div class="hero-stats">
            <div class="hero-stat">
              <div class="hero-stat-value">-48%</div>
              <div class="hero-stat-label">CO‚ÇÇ-utslipp vs riving</div>
            </div>
            <div class="hero-stat">
              <div class="hero-stat-value">-85%</div>
              <div class="hero-stat-label">Materialutslipp</div>
            </div>
            <div class="hero-stat">
              <div class="hero-stat-value">2 549</div>
              <div class="hero-stat-label">Tonn CO‚ÇÇ spart</div>
            </div>
            <div class="hero-stat">
              <div class="hero-stat-value">F ‚Üí C</div>
              <div class="hero-stat-label">Energimerke-forbedring</div>
            </div>
          </div>
        </section>

        <!-- Section 1: Klimagassberegninger -->
        <section class="section" id="klimagass">
          <div class="section-header">
            <div class="section-icon klimagass">üìä</div>
            <div>
              <h2 class="section-title">Klimagassberegninger</h2>
              <div class="section-meta">
                Vill Energi AS ‚Ä¢ 22.04.2025 ‚Ä¢ LCA-rapport ‚Ä¢ 18 sider
              </div>
            </div>
          </div>

          <!-- Report Carousel -->
          <div class="report-carousel-container" id="klimagass-carousel">
            <div class="carousel-header">
              <div class="carousel-title">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                  />
                  <polyline points="14 2 14 8 20 8" />
                </svg>
                Original rapport
              </div>
              <div class="carousel-controls">
                <span class="carousel-page-info"
                  >Side <span id="klimagass-page">1</span> av 18</span
                >
                <button
                  class="carousel-btn"
                  onclick="carouselPrev('klimagass')"
                  id="klimagass-prev"
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="15 18 9 12 15 6" />
                  </svg>
                </button>
                <button
                  class="carousel-btn"
                  onclick="carouselNext('klimagass')"
                  id="klimagass-next"
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="9 18 15 12 9 6" />
                  </svg>
                </button>
                <button
                  class="expand-btn"
                  onclick="openFullscreen('klimagass')"
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="15 3 21 3 21 9" />
                    <polyline points="9 21 3 21 3 15" />
                    <line x1="21" y1="3" x2="14" y2="10" />
                    <line x1="3" y1="21" x2="10" y2="14" />
                  </svg>
                  Ekspander
                </button>
              </div>
            </div>
            <div class="carousel-viewport">
              <img
                src="assets/reports/klimagassberegninger/page_01.jpg"
                alt="Klimagassberegninger side 1"
                class="carousel-image"
                id="klimagass-image"
                onclick="openFullscreen('klimagass')"
              />
            </div>
            <div class="carousel-dots" id="klimagass-dots"></div>
          </div>

          <!-- Scenario Comparison -->
          <h3 style="font-size: 1.25rem; margin-bottom: 1rem">
            Scenariosammenligning
          </h3>
          <div class="scenario-grid" id="scenario-grid"></div>

          <!-- CO2 Chart -->
          <div class="chart-container">
            <div class="chart-title">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <line x1="18" y1="20" x2="18" y2="10" />
                <line x1="12" y1="20" x2="12" y2="4" />
                <line x1="6" y1="20" x2="6" y2="14" />
              </svg>
              Totale klimagassutslipp per m¬≤ BTA
            </div>
            <div class="bar-chart" id="co2-chart"></div>
          </div>

          <!-- Materials vs Energy -->
          <div class="chart-container">
            <div class="chart-title">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                <line x1="3" y1="9" x2="21" y2="9" />
                <line x1="9" y1="21" x2="9" y2="9" />
              </svg>
              Fordeling: Materialer vs Energi (tonn CO‚ÇÇ-ekv.)
            </div>
            <div class="stacked-bar-chart" id="stacked-chart"></div>
            <div class="chart-legend">
              <div class="legend-item">
                <div class="legend-color segment-materials"></div>
                <span>Materialer (A1-A5, C1-C4)</span>
              </div>
              <div class="legend-item">
                <div class="legend-color segment-energy"></div>
                <span>Energibruk i drift (B6)</span>
              </div>
            </div>
          </div>

          <!-- Key Insights -->
          <div class="info-grid">
            <div class="info-card">
              <div class="info-card-header">
                <div class="info-card-icon" style="background: #ede9fe">üí°</div>
                <div class="info-card-title">N√∏kkelinnsikter</div>
              </div>
              <ul class="info-list" id="insights-list"></ul>
            </div>
            <div class="info-card">
              <div class="info-card-header">
                <div
                  class="info-card-icon"
                  style="background: var(--accent-green-light)"
                >
                  ‚ôªÔ∏è
                </div>
                <div class="info-card-title">Sirkul√¶r √∏konomi</div>
              </div>
              <div class="info-card-content">
                <p>
                  <strong>Avfallsreduksjon:</strong> 85% mindre byggavfall ved
                  rehabilitering
                </p>
                <ul class="info-list">
                  <li>üèóÔ∏è Riving: 5 000‚Äì7 000 tonn avfall</li>
                  <li>‚ôªÔ∏è Rehabilitering: 500‚Äì1 000 tonn avfall</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        <!-- Section 2: Energikartlegging -->
        <section class="section" id="energi">
          <div class="section-header">
            <div class="section-icon energi">‚ö°</div>
            <div>
              <h2 class="section-title">Energikartlegging</h2>
              <div class="section-meta">
                Vill Energi AS ‚Ä¢ 11.04.2025 ‚Ä¢ Teknisk rapport ‚Ä¢ 14 sider
              </div>
            </div>
          </div>

          <!-- Report Carousel -->
          <div class="report-carousel-container" id="energi-carousel">
            <div class="carousel-header">
              <div class="carousel-title">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                  />
                  <polyline points="14 2 14 8 20 8" />
                </svg>
                Original rapport
              </div>
              <div class="carousel-controls">
                <span class="carousel-page-info"
                  >Side <span id="energi-page">1</span> av 14</span
                >
                <button
                  class="carousel-btn"
                  onclick="carouselPrev('energi')"
                  id="energi-prev"
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="15 18 9 12 15 6" />
                  </svg>
                </button>
                <button
                  class="carousel-btn"
                  onclick="carouselNext('energi')"
                  id="energi-next"
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="9 18 15 12 9 6" />
                  </svg>
                </button>
                <button class="expand-btn" onclick="openFullscreen('energi')">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="15 3 21 3 21 9" />
                    <polyline points="9 21 3 21 3 15" />
                    <line x1="21" y1="3" x2="14" y2="10" />
                    <line x1="3" y1="21" x2="10" y2="14" />
                  </svg>
                  Ekspander
                </button>
              </div>
            </div>
            <div class="carousel-viewport">
              <img
                src="assets/reports/energikartlegging/page_01.jpg"
                alt="Energikartlegging side 1"
                class="carousel-image"
                id="energi-image"
                onclick="openFullscreen('energi')"
              />
            </div>
            <div class="carousel-dots" id="energi-dots"></div>
          </div>

          <!-- Current State -->
          <div class="energy-rating-container">
            <h3 style="margin-bottom: 0.5rem">N√•v√¶rende energitilstand</h3>
            <p style="color: var(--text-secondary); margin-bottom: 1rem">
              Bygget har i dag energimerke F med forbruk p√• 232 kWh/m¬≤/√•r
            </p>
            <div class="rating-scale">
              <div class="rating-segment rating-A">A</div>
              <div class="rating-segment rating-B">B</div>
              <div class="rating-segment rating-C">C</div>
              <div class="rating-segment rating-D">D</div>
              <div class="rating-segment rating-E">E</div>
              <div class="rating-segment rating-F" style="position: relative">
                F
                <div class="current-rating-indicator"></div>
                <div class="rating-marker">Dagens</div>
              </div>
              <div class="rating-segment rating-G">G</div>
            </div>
            <div
              style="
                margin-top: 2rem;
                display: flex;
                gap: 2rem;
                flex-wrap: wrap;
              "
            >
              <div>
                <div
                  style="
                    font-size: 2rem;
                    font-weight: 700;
                    color: var(--accent-red);
                  "
                >
                  232
                </div>
                <div style="color: var(--text-secondary); font-size: 0.9rem">
                  kWh/m¬≤/√•r (n√•)
                </div>
              </div>
              <div>
                <div
                  style="
                    font-size: 2rem;
                    font-weight: 700;
                    color: var(--accent-green);
                  "
                >
                  116
                </div>
                <div style="color: var(--text-secondary); font-size: 0.9rem">
                  kWh/m¬≤/√•r (m√•l)
                </div>
              </div>
              <div>
                <div
                  style="
                    font-size: 2rem;
                    font-weight: 700;
                    color: var(--accent-blue);
                  "
                >
                  -50%
                </div>
                <div style="color: var(--text-secondary); font-size: 0.9rem">
                  Forbedring
                </div>
              </div>
            </div>
          </div>

          <!-- Recommended Packages -->
          <h3 style="font-size: 1.25rem; margin-bottom: 1rem">
            Anbefalte tiltakspakker
          </h3>
          <div class="package-grid" id="package-grid"></div>

          <!-- All Measures Table -->
          <h3 style="font-size: 1.25rem; margin-bottom: 1rem">
            Alle vurderte tiltak
          </h3>
          <div class="data-table-container">
            <table class="data-table" id="measures-table">
              <thead>
                <tr>
                  <th>Nr</th>
                  <th>Tiltak</th>
                  <th>Investering</th>
                  <th>Besparelse/√•r</th>
                  <th>NNV 25 √•r</th>
                  <th>LCOE</th>
                  <th>Energimerke</th>
                </tr>
              </thead>
              <tbody id="measures-tbody"></tbody>
            </table>
          </div>

          <!-- 2026 Changes -->
          <div class="info-card" style="margin-bottom: 2rem">
            <div class="info-card-header">
              <div
                class="info-card-icon"
                style="background: var(--accent-orange-light)"
              >
                üìÖ
              </div>
              <div class="info-card-title">Endringer fra 1. januar 2026</div>
            </div>
            <div class="info-card-content">
              <p>
                Fra 2026 vil fjernvarme vektes med faktor 0,45 i
                energimerkeberegningen. Dette betyr at 1 kWh fjernvarme telles
                som 0,45 kWh.
              </p>
              <p style="margin-top: 0.75rem">
                <strong>Konsekvens for Hovfaret 13:</strong>
              </p>
              <ul class="info-list">
                <li>üìä Dagens situasjon: F ‚Üí D (166 kWh/m¬≤)</li>
                <li>‚ö° Med VAV + aggregater: D ‚Üí C (119 kWh/m¬≤)</li>
                <li>üî• Med varmepumpe: D ‚Üí C (145 kWh/m¬≤)</li>
              </ul>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <h4>Kilder</h4>
          <p>Energikartlegging Hovfaret 13 (11.04.2025)</p>
          <p>Klimagassberegninger Hovfaret 13 v2 (22.04.2025)</p>
          <p>Utf√∏rt av Vill Energi AS</p>
        </div>
        <div class="footer-section">
          <h4>Prosjekt</h4>
          <a href="project-story.html">Prosjekthistorie</a>
          <a href="scenarios.html">Scenariosammenligning</a>
          <a href="command-center.html">Command Center</a>
        </div>
        <div class="footer-section">
          <h4>Kontakt</h4>
          <p>Natural State AS</p>
          <p>Urbania Eiendom AS</p>
        </div>
      </div>
    </footer>

    <!-- Fullscreen Modal -->
    <div class="fullscreen-modal" id="fullscreen-modal">
      <button class="fullscreen-close" onclick="closeFullscreen()">√ó</button>
      <div class="fullscreen-image-container" id="fullscreen-container">
        <img src="" alt="" class="fullscreen-image" id="fullscreen-image" />
      </div>
      <div class="fullscreen-controls">
        <button class="fullscreen-btn" onclick="fullscreenPrev()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="15 18 9 12 15 6" />
          </svg>
        </button>
        <span class="fullscreen-page-info" id="fullscreen-page-info"
          >1 / 18</span
        >
        <button class="fullscreen-btn" onclick="fullscreenNext()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="9 18 15 12 9 6" />
          </svg>
        </button>
        <div class="zoom-controls">
          <button class="fullscreen-btn" onclick="zoomOut()">‚àí</button>
          <button class="fullscreen-btn" onclick="zoomIn()">+</button>
          <button class="fullscreen-btn" onclick="zoomReset()">‚ü≤</button>
        </div>
      </div>
    </div>

    <script>
      // DATA
      const carousels = {
        klimagass: {
          folder: "assets/reports/klimagassberegninger",
          pages: 18,
          current: 1,
        },
        energi: {
          folder: "assets/reports/energikartlegging",
          pages: 14,
          current: 1,
        },
      };

      const scenarios = [
        {
          id: "scenario_1",
          name: "Nybygg og riving",
          icon: "üèóÔ∏è",
          status: "Ikke anbefalt",
          class: "not-recommended",
          description:
            "Dagens bygg rives og nytt bygges 2m fra elven. H√∏yest klimabelastning.",
          totals: { materials: 2641, energy: 2702, total: 5343 },
          perBTA: { materials: 312, energy: 319, total: 631 },
        },
        {
          id: "scenario_2",
          name: "Rehabilitering",
          icon: "‚ôªÔ∏è",
          status: "Anbefalt",
          class: "recommended",
          description:
            "Bevare og oppgradere eksisterende bygg. Lavest klimabelastning.",
          totals: { materials: 377, energy: 2417, total: 2794 },
          perBTA: { materials: 62, energy: 395, total: 456 },
          vs: { total: -48, materials: -86 },
        },
        {
          id: "scenario_3",
          name: "P√•bygg",
          icon: "üè•",
          status: "Foretrukket",
          class: "preferred",
          description:
            "Rehabilitering + 3 etasjer Omsorg+ boliger. Beste samfunnsnytte.",
          totals: { materials: 1043, energy: 3118, total: 4161 },
          perBTA: { materials: 123, energy: 368, total: 491 },
          vs: { total: -22, materials: -61 },
        },
      ];

      const measures = [
        {
          id: 1,
          name: "VAV og nye aggregater",
          investment: 6025000,
          savings: 570000,
          npv: 2880000,
          lcoe: 0.51,
          rating: "D",
          rating2026: "C",
          recommended: true,
        },
        {
          id: 2,
          name: "VAV eksisterende aggregater",
          investment: 1598000,
          savings: 343000,
          npv: 3760000,
          lcoe: 0.22,
          rating: "E",
          rating2026: "C",
          recommended: false,
        },
        {
          id: 3,
          name: "Roterende varmegjenvinner",
          investment: 150000,
          savings: 368000,
          npv: 5599000,
          lcoe: 0.02,
          rating: "E",
          rating2026: "C",
          recommended: false,
        },
        {
          id: 4,
          name: "Etterisolere yttervegg",
          investment: 4074000,
          savings: 10000,
          npv: -3918000,
          lcoe: 9.78,
          rating: "F",
          rating2026: "D",
          recommended: false,
        },
        {
          id: 5,
          name: "LED-belysning",
          investment: 303000,
          savings: 1000,
          npv: -287000,
          lcoe: 18.19,
          rating: "F",
          rating2026: "D",
          recommended: false,
        },
        {
          id: 6,
          name: "Nattkj√∏ling",
          investment: 250000,
          savings: 1000,
          npv: -234000,
          lcoe: 12.0,
          rating: "F",
          rating2026: "D",
          recommended: false,
        },
        {
          id: 7,
          name: "Utskifting av vinduer",
          investment: 8000000,
          savings: 211000,
          npv: -4704000,
          lcoe: 1.82,
          rating: "E",
          rating2026: "D",
          recommended: false,
        },
        {
          id: 8,
          name: "Glassvinduer plan 1",
          investment: 150000,
          savings: 21000,
          npv: 178000,
          lcoe: 0.34,
          rating: "F",
          rating2026: "D",
          recommended: true,
        },
        {
          id: 9,
          name: "Luft til vann varmepumpe",
          investment: 3492000,
          savings: 574000,
          npv: 5475000,
          lcoe: 0.24,
          rating: "D",
          rating2026: "C",
          recommended: true,
        },
        {
          id: 10,
          name: "Varmepumpe + ombygging",
          investment: 9941000,
          savings: 574000,
          npv: -974000,
          lcoe: 0.69,
          rating: "D",
          rating2026: "C",
          recommended: false,
        },
      ];

      const packages = [
        {
          name: "Tiltakspakke 1",
          measures: "VAV + nye aggregater + vinduer plan 1",
          investment: 6175000,
          consumption: 153,
          savings: 588000,
          npv: 3010000,
          rating: "D",
          rating2026: "C",
        },
        {
          name: "Tiltakspakke 2",
          measures: "VAV + aggregater + vinduer + varmepumpe",
          investment: 9667000,
          consumption: 116,
          savings: 862000,
          npv: 3800000,
          rating: "C",
          rating2026: "B",
        },
      ];

      const insights = [
        "Produksjon av materialer (A1-A3) er den st√∏rste forskjellen mellom scenarioene",
        "Scenario 1 har betydelig st√∏rre utslipp for grunn/fundamenter pga. betong og st√•l",
        "Massebehandling er ikke inkludert - Scenario 1 har h√∏yere faktiske utslipp",
        "Fundamentet er allerede dimensjonert for 12 etasjer",
      ];

      // CAROUSEL FUNCTIONS
      function initCarousels() {
        Object.keys(carousels).forEach((id) => {
          const carousel = carousels[id];
          const dotsContainer = document.getElementById(`${id}-dots`);
          dotsContainer.innerHTML = "";
          for (let i = 1; i <= carousel.pages; i++) {
            const dot = document.createElement("div");
            dot.className = `carousel-dot${i === 1 ? " active" : ""}`;
            dot.onclick = () => goToPage(id, i);
            dotsContainer.appendChild(dot);
          }
          updateCarouselButtons(id);
        });
      }

      function goToPage(id, page) {
        const carousel = carousels[id];
        carousel.current = page;
        document.getElementById(`${id}-image`).src =
          `${carousel.folder}/page_${String(page).padStart(2, "0")}.jpg`;
        document.getElementById(`${id}-page`).textContent = page;
        document
          .querySelectorAll(`#${id}-dots .carousel-dot`)
          .forEach((dot, i) => {
            dot.classList.toggle("active", i + 1 === page);
          });
        updateCarouselButtons(id);
      }

      function carouselPrev(id) {
        if (carousels[id].current > 1) goToPage(id, carousels[id].current - 1);
      }
      function carouselNext(id) {
        if (carousels[id].current < carousels[id].pages)
          goToPage(id, carousels[id].current + 1);
      }
      function updateCarouselButtons(id) {
        document.getElementById(`${id}-prev`).disabled =
          carousels[id].current === 1;
        document.getElementById(`${id}-next`).disabled =
          carousels[id].current === carousels[id].pages;
      }

      // FULLSCREEN
      let fullscreenState = { active: null, zoom: 1 };

      function openFullscreen(id) {
        const carousel = carousels[id];
        fullscreenState.active = id;
        fullscreenState.zoom = 1;
        const img = document.getElementById("fullscreen-image");
        img.src = `${carousel.folder}/page_${String(carousel.current).padStart(2, "0")}.jpg`;
        img.style.transform = "scale(1)";
        img.classList.remove("zoomed");
        updateFullscreenInfo();
        document.getElementById("fullscreen-modal").classList.add("active");
        document.body.style.overflow = "hidden";
      }

      function closeFullscreen() {
        document.getElementById("fullscreen-modal").classList.remove("active");
        document.body.style.overflow = "";
        fullscreenState.active = null;
      }

      function updateFullscreenInfo() {
        const carousel = carousels[fullscreenState.active];
        document.getElementById("fullscreen-page-info").textContent =
          `${carousel.current} / ${carousel.pages}`;
      }

      function fullscreenPrev() {
        const id = fullscreenState.active;
        const carousel = carousels[id];
        if (carousel.current > 1) {
          carousel.current--;
          document.getElementById("fullscreen-image").src =
            `${carousel.folder}/page_${String(carousel.current).padStart(2, "0")}.jpg`;
          updateFullscreenInfo();
          goToPage(id, carousel.current);
        }
      }

      function fullscreenNext() {
        const id = fullscreenState.active;
        const carousel = carousels[id];
        if (carousel.current < carousel.pages) {
          carousel.current++;
          document.getElementById("fullscreen-image").src =
            `${carousel.folder}/page_${String(carousel.current).padStart(2, "0")}.jpg`;
          updateFullscreenInfo();
          goToPage(id, carousel.current);
        }
      }

      function zoomIn() {
        fullscreenState.zoom = Math.min(fullscreenState.zoom + 0.5, 3);
        applyZoom();
      }
      function zoomOut() {
        fullscreenState.zoom = Math.max(fullscreenState.zoom - 0.5, 0.5);
        applyZoom();
      }
      function zoomReset() {
        fullscreenState.zoom = 1;
        applyZoom();
      }
      function applyZoom() {
        const img = document.getElementById("fullscreen-image");
        img.style.transform = `scale(${fullscreenState.zoom})`;
        img.classList.toggle("zoomed", fullscreenState.zoom > 1);
      }

      document.addEventListener("keydown", (e) => {
        if (!fullscreenState.active) return;
        switch (e.key) {
          case "Escape":
            closeFullscreen();
            break;
          case "ArrowLeft":
            fullscreenPrev();
            break;
          case "ArrowRight":
            fullscreenNext();
            break;
          case "+":
          case "=":
            zoomIn();
            break;
          case "-":
            zoomOut();
            break;
          case "0":
            zoomReset();
            break;
        }
      });

      // RENDER FUNCTIONS
      function renderScenarios() {
        document.getElementById("scenario-grid").innerHTML = scenarios
          .map(
            (s) => `
        <div class="scenario-card ${s.class}">
          <div class="scenario-header">
            <div class="scenario-icon">${s.icon}</div>
            <div>
              <div class="scenario-name">${s.name}</div>
              <span class="scenario-status">${s.status}</span>
            </div>
          </div>
          <div class="scenario-body">
            <p class="scenario-description">${s.description}</p>
            <div class="scenario-metrics">
              <div class="scenario-metric">
                <span class="metric-label">Totalt CO‚ÇÇ</span>
                <span class="metric-value">${s.totals.total.toLocaleString("no-NO")} tonn</span>
              </div>
              <div class="scenario-metric">
                <span class="metric-label">Per m¬≤ BTA</span>
                <span class="metric-value">${s.perBTA.total} kg${s.vs ? `<span class="metric-comparison positive">${s.vs.total}%</span>` : ""}</span>
              </div>
              <div class="scenario-metric">
                <span class="metric-label">Materialer</span>
                <span class="metric-value">${s.perBTA.materials} kg/m¬≤${s.vs ? `<span class="metric-comparison positive">${s.vs.materials}%</span>` : ""}</span>
              </div>
            </div>
          </div>
        </div>
      `,
          )
          .join("");
      }

      function renderCO2Chart() {
        const maxValue = Math.max(...scenarios.map((s) => s.perBTA.total));
        document.getElementById("co2-chart").innerHTML = scenarios
          .map(
            (s, i) => `
        <div class="bar-row">
          <div class="bar-label">${s.name}</div>
          <div class="bar-track">
            <div class="bar-fill scenario-${i + 1}" style="width: ${(s.perBTA.total / maxValue) * 100}%">${s.perBTA.total} kg</div>
          </div>
        </div>
      `,
          )
          .join("");
      }

      function renderStackedChart() {
        const maxTotal = Math.max(...scenarios.map((s) => s.totals.total));
        document.getElementById("stacked-chart").innerHTML = scenarios
          .map(
            (s) => `
        <div class="stacked-row">
          <div class="bar-label">${s.name}</div>
          <div class="stacked-bar">
            <div class="stacked-segment segment-materials" style="width: ${(s.totals.materials / maxTotal) * 100}%">${s.totals.materials.toLocaleString("no-NO")}</div>
            <div class="stacked-segment segment-energy" style="width: ${(s.totals.energy / maxTotal) * 100}%">${s.totals.energy.toLocaleString("no-NO")}</div>
          </div>
        </div>
      `,
          )
          .join("");
      }

      function renderInsights() {
        document.getElementById("insights-list").innerHTML = insights
          .map((i) => `<li>üí° ${i}</li>`)
          .join("");
      }

      function renderPackages() {
        document.getElementById("package-grid").innerHTML = packages
          .map(
            (p) => `
        <div class="package-card">
          <div class="package-header">
            <div class="package-name">${p.name}</div>
            <div class="package-measures">${p.measures}</div>
          </div>
          <div class="package-body">
            <div class="package-metric"><span class="package-metric-label">Investering</span><span class="package-metric-value">${(p.investment / 1000000).toFixed(2)} MNOK</span></div>
            <div class="package-metric"><span class="package-metric-label">Forbruk etter</span><span class="package-metric-value">${p.consumption} kWh/m¬≤/√•r</span></div>
            <div class="package-metric"><span class="package-metric-label">√Örlig besparelse</span><span class="package-metric-value">${(p.savings / 1000).toLocaleString("no-NO")} kNOK</span></div>
            <div class="package-metric"><span class="package-metric-label">NNV 25 √•r</span><span class="package-metric-value npv-positive">+${(p.npv / 1000000).toFixed(1)} MNOK</span></div>
            <div class="package-rating">
              <span>Energimerke:</span>
              <span class="rating-badge rating-${p.rating}">${p.rating}</span>
              <span>‚Üí</span>
              <span class="rating-badge rating-${p.rating2026}">${p.rating2026}</span>
              <span style="font-size: 0.8rem; color: var(--text-muted);">(2026)</span>
            </div>
          </div>
        </div>
      `,
          )
          .join("");
      }

      function renderMeasuresTable() {
        document.getElementById("measures-tbody").innerHTML = measures
          .map(
            (m) => `
        <tr class="${m.recommended ? "recommended-row" : ""}">
          <td>${m.id}</td>
          <td>${m.name} ${m.recommended ? "‚≠ê" : ""}</td>
          <td>${(m.investment / 1000000).toFixed(2)} MNOK</td>
          <td>${(m.savings / 1000).toLocaleString("no-NO")} kNOK</td>
          <td class="${m.npv >= 0 ? "npv-positive" : "npv-negative"}">${m.npv >= 0 ? "+" : ""}${(m.npv / 1000000).toFixed(2)} MNOK</td>
          <td>${m.lcoe.toFixed(2)}</td>
          <td>
            <span class="rating-badge rating-${m.rating}" style="width: 24px; height: 24px; font-size: 0.8rem;">${m.rating}</span>
            ‚Üí
            <span class="rating-badge rating-${m.rating2026}" style="width: 24px; height: 24px; font-size: 0.8rem;">${m.rating2026}</span>
          </td>
        </tr>
      `,
          )
          .join("");
      }

      // NAVIGATION
      function scrollToSection(id) {
        document.getElementById(id).scrollIntoView({ behavior: "smooth" });
        document.querySelectorAll(".report-nav-btn").forEach((btn) => {
          btn.classList.toggle(
            "active",
            btn.textContent.toLowerCase().includes(id),
          );
        });
      }

      window.addEventListener("scroll", () => {
        const scrollPos = window.scrollY + 200;
        ["klimagass", "energi"].forEach((id) => {
          const section = document.getElementById(id);
          if (
            section &&
            scrollPos >= section.offsetTop &&
            scrollPos < section.offsetTop + section.offsetHeight
          ) {
            document.querySelectorAll(".report-nav-btn").forEach((btn) => {
              btn.classList.toggle(
                "active",
                btn.textContent.toLowerCase().includes(id),
              );
            });
          }
        });
      });

      // JOURNEY DATA
      const journeyData = [
        {
          id: "s_001",
          date: "2023-11-21",
          type: "foundation",
          title: "B√¶rekraft som grunnprinsipp",
          description:
            "F√∏rste strategim√∏te etablerer b√¶rekraft og sirkul√¶r √∏konomi som kjerneargumentasjon.",
          category: "strategy",
          icon: "üå±",
        },
        {
          id: "s_002",
          date: "2024-03-11",
          type: "strategy",
          title: "Milj√∏gevinster som politisk verkt√∏y",
          description:
            "B√¶rekraft etablert som hovedargument for omr√•deplan-endring.",
          category: "strategy",
          icon: "üìã",
        },
        {
          id: "s_003",
          date: "2024-04-12",
          type: "strategy",
          title: "Referanseprosjekt posisjonert",
          description:
            "Strateginotat posisjonerer Hovfaret 13 som katalysator for b√¶rekraftig byutvikling.",
          category: "strategy",
          icon: "üéØ",
        },
        {
          id: "s_004",
          date: "2024-05-08",
          type: "content",
          title: "Sirkul√¶re slides utviklet",
          description:
            "11 strategiske hovedpunkter for sirkul√¶r stedsutvikling.",
          category: "content",
          icon: "‚ôªÔ∏è",
        },
        {
          id: "s_005",
          date: "2024-05-30",
          type: "analysis",
          title: "Geoteknisk analyse startet",
          description:
            "Kvikkleire og grunnvannsforhold kartlagt - rehabilitering anbefalt.",
          category: "technical",
          icon: "üîç",
        },
        {
          id: "s_006",
          date: "2024-06-03",
          type: "milestone",
          title: "Energimerke F utstedt",
          description: "N√•v√¶rende energiforbruk: 232 kWh/m¬≤/√•r dokumentert.",
          category: "technical",
          icon: "‚ö°",
        },
        {
          id: "s_007",
          date: "2024-12-11",
          type: "milestone",
          title: "Vill Energi-samarbeid",
          description:
            "Befaring med Vill Energi AS for teknisk energikartlegging.",
          category: "technical",
          icon: "ü§ù",
        },
        {
          id: "s_008",
          date: "2025-01-23",
          type: "analysis",
          title: "Milj√∏risiko kartlagt",
          description:
            "ROS-analyse og kvikkleirevurdering - rehabilitering avlaster omr√•det.",
          category: "technical",
          icon: "‚ö†Ô∏è",
        },
        {
          id: "s_009",
          date: "2025-04-11",
          type: "deliverable",
          title: "Energikartlegging ferdig",
          description: "14 siders rapport: 50% energireduksjon mulig, F ‚Üí C.",
          category: "deliverable",
          icon: "üìä",
          metrics: { rating: "F ‚Üí C", savings: "50%" },
        },
        {
          id: "s_010",
          date: "2025-04-22",
          type: "deliverable",
          title: "Klimagassberegninger ferdig",
          description:
            "18 siders LCA-rapport: 48% CO‚ÇÇ-besparelse, 2 549 tonn spart.",
          category: "deliverable",
          icon: "üåç",
          metrics: { co2: "48%", tonnes: "2 549" },
        },
        {
          id: "s_011",
          date: "2025-07-04",
          type: "deliverable",
          title: "B√¶rekraftsrapport levert",
          description: "83-siders ESRS-rapport med Triple Bottom Line-analyse.",
          category: "deliverable",
          icon: "üìö",
          metrics: { pages: "83", framework: "ESRS" },
        },
        {
          id: "s_012",
          date: "2025-09-05",
          type: "decision",
          title: "Strategisk akselerasjon",
          description:
            "Beslutning om direkte Omsorg+-strategi basert p√• b√¶rekraftscasen.",
          category: "decision",
          icon: "üöÄ",
        },
        {
          id: "s_013",
          date: "2025-09-05",
          type: "partnership",
          title: "Nordic Circle Hotspot",
          description: "Pilot-partner for sirkul√¶re byggematerialer.",
          category: "partnership",
          icon: "üîó",
        },
        {
          id: "s_014",
          date: "2025-10-14",
          type: "engagement",
          title: "Nabolagsm√∏te",
          description:
            "~30 naboer informert om b√¶rekraftscase og transformasjon.",
          category: "engagement",
          icon: "üë•",
        },
        {
          id: "s_015",
          date: "2025-10-16",
          type: "regulatory",
          title: "Nabovarsel sendt",
          description: "Formelt nabovarsel sendt til alle ber√∏rte naboer.",
          category: "regulatory",
          icon: "üì¨",
        },
        {
          id: "s_016",
          date: "2025-10-30",
          type: "regulatory",
          title: "Bruksendringss√∏knad p√•g√•r",
          description: "S√∏knad under utarbeidelse hos Byggesaksr√•dgivning AS.",
          category: "regulatory",
          icon: "üìù",
        },
        {
          id: "s_017",
          date: "2025-12-01",
          type: "milestone",
          title: "Konseptskisse 2.0",
          description:
            "Alle b√¶rekraftsleveranser integrert i oppdatert konseptskisse.",
          category: "deliverable",
          icon: "‚úÖ",
        },
      ];

      // JOURNEY RENDERING
      function renderJourney() {
        const container = document.getElementById("journey-timeline");
        if (!container) return;

        container.innerHTML = journeyData
          .map((item, index) => {
            const date = new Date(item.date);
            const monthYear = date.toLocaleDateString("no-NO", {
              month: "short",
              year: "numeric",
            });
            const metricsHtml = item.metrics
              ? `
          <div class="journey-metrics">
            ${Object.entries(item.metrics)
              .map(([key, val]) => `<span class="metric">${val}</span>`)
              .join("")}
          </div>`
              : "";

            return `
          <div class="journey-item ${item.category}" data-id="${item.id}">
            <div class="journey-dot ${item.category}"></div>
            <div class="journey-content">
              <div class="journey-date">${monthYear}</div>
              <div class="journey-icon">${item.icon}</div>
              <div class="journey-title">${item.title}</div>
              <div class="journey-description">${item.description}</div>
              ${metricsHtml}
            </div>
          </div>`;
          })
          .join("");
      }

      // INIT
      document.addEventListener("DOMContentLoaded", () => {
        initCarousels();
        renderScenarios();
        renderCO2Chart();
        renderStackedChart();
        renderInsights();
        renderPackages();
        renderMeasuresTable();
        renderJourney();
      });
    </script>
  </body>
</html>
